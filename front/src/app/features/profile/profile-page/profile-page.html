<section class="min-h-screen bg-white">
  <div class="container-page py-8">

    <h1 class="text-2xl text-center w-full font-bold mb-4">
      Profil utilisateur
    </h1>

    <!-- Form -->
    <form
      [formGroup]="profileForm"
      (ngSubmit)="onSubmit()"
      class="max-w-sm mx-auto flex flex-col gap-7 mt-8"
    >
      @if (generalErrors().length > 0) {
        <div class="bg-danger-50 border border-danger-200 text-danger-800 px-4 py-3 rounded-lg text-sm">
          @for (error of generalErrors(); track error) {
            <p>{{ error }}</p>
          }
        </div>
      }

      <app-form-input
        formControlName="username"
        type="text"
        placeholder="Username"
        [errorMessage]="getFieldError('username')"
        [formControlDisabled]="isSubmitting()"
        [required]="true">
      </app-form-input>

      <app-form-input
        formControlName="email"
        type="email"
        placeholder="email@email.fr"
        [errorMessage]="getFieldError('email')"
        [formControlDisabled]="isSubmitting()"
        [required]="true">
      </app-form-input>

      <app-form-input
        formControlName="password"
        type="password"
        placeholder="Mot de passe"
        [errorMessage]="getFieldError('password')"
        [formControlDisabled]="isSubmitting()"
      >
      </app-form-input>

      <button
        type="submit"
        class="btn-primary mx-auto mt-2"
        [disabled]="isSubmitting() || profileForm.invalid"
      >
        @if (isSubmitting()) {
          Enregistrement en cours...
        } @else {
          Sauvegarder
        }
      </button>

    </form>


    @if(topicsList().length)
    {
    <hr class="my-6">
    <h2 class="text-2xl text-center w-full font-bold mb-4">Abonnements</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6">
      @for (topic of topicsList(); track topic.id) {
        <article class="
        bg-secondary-100
        rounded-lg
        p-6
        transition-all
        min-h-56
        flex flex-col justify-between items-center
        "
        >
          <section>
            <h2 class="text-xl font-semibold text-mdd-text mb-3">{{topic.name}}</h2>
            <p class="text-sm/5 text-mdd-text ellipsis-5-lines">
              {{topic.description}}
            </p>
          </section>
          <button class="btn-primary w-50"
                  (click)="unsubscribeFromTopic(topic.id)"
          >Se d√©sabonner</button>


        </article>
      }
    </div>
    }


  </div>

</section>
